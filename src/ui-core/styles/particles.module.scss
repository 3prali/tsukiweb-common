@use 'sass:math';

.particles {
	position: absolute;
	inset: 0;
	-webkit-mask-image: linear-gradient(to top, black 0%, transparent 80%);
	mask-image: linear-gradient(to top, black 0%, transparent 60%);
	pointer-events: none;
	overflow: hidden;
}

.circleContainer {
	$particleNum: 50;
	$particleBaseSize: 8;
	$particleColor: hsl(180, 100%, 80%);

	position: absolute;
	animation-iteration-count: infinite;
	animation-timing-function: linear;
	will-change: transform;

	.circle {
		width: 100%;
		height: 100%;
		border-radius: 50%;
		mix-blend-mode: screen;
		background-image: radial-gradient(
			hsl(180, 100%, 80%),
			hsl(180, 100%, 80%) 10%,
			hsla(180, 100%, 80%, 0) 56%
		);
		animation: scale-frames 2s infinite;
		will-change: transform;

		@keyframes scale-frames {
			0%   { transform: scale3d(0.4, 0.4, 1); }
			50%  { transform: scale3d(2.2, 2.2, 1); }
			100% { transform: scale3d(0.4, 0.4, 1); }
		}
	}

	@for $i from 1 through $particleNum {
		&:nth-child(#{$i}) {
			$circleSize: math.random($particleBaseSize);
			width: #{$circleSize}px;
			height: #{$circleSize}px;

			$startY: 100 + math.random(10);
			$endOvershoot: 10 + math.random(20);

			$oldTopOvershoot: math.random(30);
			$oldLen: $startY + ($startY + $oldTopOvershoot);
			$newLen: $startY + $endOvershoot;
			$baseDuration: 22000 + math.random(7000);
			$moveDuration: $baseDuration * math.div($newLen, $oldLen);

			$fromX: math.random(100);
			$deltaX: math.random(30) - 15;
			$toX: math.max(0, math.min(100, $fromX + $deltaX));

			$framesName: move-frames-#{$i};

			animation-name: #{$framesName};
			animation-duration: #{$moveDuration}ms;
			animation-delay: #{math.random(37000)}ms;

			@keyframes #{$framesName} {
				from {
					transform: translate3d(
						#{$fromX}vw,
						#{$startY}vh,
						0
					);
				}

				to {
					transform: translate3d(
						#{$toX}vw,
						#{$endOvershoot}vh,
						0
					);
				}
			}

			.circle {
				animation-delay: #{math.random(4000)}ms;
			}
		}
	}
}

@media (prefers-reduced-motion: reduce) {
	.particles {
		display: none;
	}
}